/*
Template Name: STUDIO - Responsive Bootstrap 5 Admin Template
Version: 3.0.0
Author: Sean Ngu
	----------------------------
		APPS CONTENT TABLE
	----------------------------

	<!-- ======== GLOBAL SCRIPT SETTING ======== -->
  01. Global Variable
  02. Handle Scrollbar
  03. Handle Sidebar Menu
  04. Handle Sidebar Minify
  05. Handle Sidebar Minify Float Menu
  06. Handle Dropdown Close Option
  07. Handle Card - Remove / Reload / Collapse / Expand
  08. Handle Tooltip & Popover Activation
  09. Handle Scroll to Top Button Activation
  10. Handle hexToRgba
  11. Handle Scroll to
  12. Handle Theme Panel Expand
  13. Handle Theme Page Control
  14. Handle Enable Tooltip & Popover
	
	<!-- ======== APPLICATION SETTING ======== -->
	Application Controller
*/



/* 01. Global Variable
------------------------------------------------ */
var app = {
	font: {
	
	},
	color: {
	
	}
}


/* 02. Handle Scrollbar
------------------------------------------------ */
var handleSlimScroll = function() {
	"use strict";
	$.when($('[data-scrollbar=true]').each( function() {
		generateSlimScroll($(this));
	})).done(function() {
		$('[data-scrollbar="true"]').mouseover();
	});
};
var generateSlimScroll = function(element) {
	var isMobile = (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));
	
	if ($(element).attr('data-init') || (isMobile && $(element).attr('data-skip-mobile'))) {
		return;
	}
	var dataHeight = $(element).attr('data-height');
		dataHeight = (!dataHeight) ? $(element).height() : dataHeight;

	var scrollBarOption = {
		height: dataHeight, 
		alwaysVisible: false
	};
	if(isMobile) {
		$(element).css('height', dataHeight);
		$(element).css('overflow-x','scroll');
	} else {
		$(element).slimScroll(scrollBarOption);
		$(element).closest('.slimScrollDiv').find('.slimScrollBar').hide();
	}
	$(element).attr('data-init', true);
};


/* 03. Handle Sidebar Menu
------------------------------------------------ */
var handleSidebarMenu = function() {
	"use strict";
	$(document).on('click', '.app-sidebar .menu > .menu-item.has-sub > .menu-link', function(e) {
		e.preventDefault();
		
		var target = $(this).next('.menu-submenu');
		var otherMenu = $('.app-sidebar .menu > .menu-item.has-sub > .menu-submenu').not(target);

		if ($('.app-sidebar-minified').length === 0) {
			$(otherMenu).slideUp(250);
			$(otherMenu).closest('.menu-item').removeClass('expand');
			
			$(target).slideToggle(250);
			var targetElm = $(target).closest('.menu-item');
			if ($(targetElm).hasClass('expand')) {
				$(targetElm).removeClass('expand');
			} else {
				$(targetElm).addClass('expand');
			}
		}
	});
	$(document).on('click', '.app-sidebar .menu > .menu-item.has-sub .menu-submenu .menu-item.has-sub > .menu-link', function(e) {
		e.preventDefault();
		
		if ($('.app-sidebar-minified').length === 0) {
			var target = $(this).next('.menu-submenu');
			$(target).slideToggle(250);
		}
	});
};


/* 04. Handle Sidebar Minify
------------------------------------------------ */
var MOBILE_SIDEBAR_TOGGLE_CLASS = 'app-sidebar-mobile-toggled';
var MOBILE_SIDEBAR_CLOSED_CLASS = 'app-sidebar-mobile-closed';
var handleSidebarMinify = function() {
	$('[data-toggle="sidebar-minify"]').on('click', function(e) {
		e.preventDefault();
		
		var targetElm = '#app';
		var targetClass = 'app-sidebar-minified';
		
		if ($(targetElm).hasClass(targetClass)) {
			$(targetElm).removeClass(targetClass);
			localStorage.removeItem('appSidebarMinified');
		} else {
			$(targetElm).addClass(targetClass);
			localStorage.setItem('appSidebarMinified', true);
		}
	});
	
	if (typeof(Storage) !== 'undefined') {
		if (localStorage.appSidebarMinified) {
			$('#app').addClass('app-sidebar-minified');
		}
	}
};
var handleSidebarMobileToggle = function() {
	$(document).on('click', '[data-toggle="sidebar-mobile"]', function(e) {
		e.preventDefault();
		
		var targetElm = '#app';
		
		$(targetElm).removeClass(MOBILE_SIDEBAR_CLOSED_CLASS).addClass(MOBILE_SIDEBAR_TOGGLE_CLASS);
	});
};
var handleSidebarMobileDismiss = function() {
	$(document).on('click', '[data-dismiss="sidebar-mobile"]', function(e) {
		e.preventDefault();
		
		var targetElm = '#app';
		
		$(targetElm).removeClass(MOBILE_SIDEBAR_TOGGLE_CLASS).addClass(MOBILE_SIDEBAR_CLOSED_CLASS);
		setTimeout(function() {
			$(targetElm).removeClass(MOBILE_SIDEBAR_CLOSED_CLASS);
		}, 250);
	});
};


/* 05. Handle Sidebar Minify Float Menu
------------------------------------------------ */
var floatSubMenuTimeout;
var targetFloatMenu;
var handleMouseoverFloatSubMenu = function(elm) {
	clearTimeout(floatSubMenuTimeout);
};
var handleMouseoutFloatSubMenu = function(elm) {
	floatSubMenuTimeout = setTimeout(function() {
		$('.app-float-submenu').remove();
	}, 250);
};
var handleSidebarMinifyFloatMenu = function() {
	$(document).on('click', '.app-float-submenu .menu-item.has-sub > .menu-link', function(e) {
		e.preventDefault();
		
		var target = $(this).next('.menu-submenu');
		$(target).slideToggle(250, function() {
			var targetMenu = $('.app-float-submenu');
			var targetHeight = $(targetMenu).height() + 20;
			var targetOffset = $(targetMenu).offset();
			var targetTop = $(targetMenu).attr('data-offset-top');
			var windowHeight = $(window).height();
			if ((windowHeight - targetTop) > targetHeight) {
				$('.app-float-submenu').css({
					'top': targetTop,
					'bottom': 'auto',
					'overflow': 'initial'
				});
			} else {
				$('.app-float-submenu').css({
					'bottom': 0,
					'overflow': 'scroll'
				});
			}
		});
	});
	$(document).on('mouseover', '.app-sidebar-minified .app-sidebar .menu .menu-item.has-sub > .menu-link', function() {
		clearTimeout(floatSubMenuTimeout);
		
		var targetMenu = $(this).closest('.menu-item').find('.menu-submenu').first();
		if (targetFloatMenu == this) {
			return false;
		} else {
			targetFloatMenu = this;
		}
		var targetMenuHtml = $(targetMenu).html();
		
		if (targetMenuHtml) {
			var targetHeight = $(targetMenu).height() + 20;
			var targetOffset = $(this).offset();
			var targetTop = targetOffset.top - $(window).scrollTop();
			var targetLeft = ($('body').css('direction') != 'rtl') ? $('#sidebar').width() + $('#sidebar').offset().left : 'auto';
			var targetRight = ($('body').css('direction') != 'rtl') ? 'auto' : $('#sidebar').width();
			var windowHeight = $(window).height();
			var submenuHeight = 0;
			
			if ($('.app-float-submenu').length == 0) {
				targetMenuHtml = '<div class="app-float-submenu" data-offset-top="'+ targetTop +'" onmouseover="handleMouseoverFloatSubMenu(this)" onmouseout="handleMouseoutFloatSubMenu(this)">' + targetMenuHtml + '</div>';
				$('body').append(targetMenuHtml);
			} else {
				$('.app-float-submenu').html(targetMenuHtml);
			}
			submenuHeight = $('.app-float-submenu').height();
			if ((windowHeight - targetTop) > targetHeight && ((targetTop + submenuHeight) < windowHeight)) {
				$('.app-float-submenu').css({
					'top': targetTop,
					'left': targetLeft,
					'bottom': 'auto',
					'right': targetRight
				});
			} else {
				$('.app-float-submenu').css({
					'bottom': 0,
					'top': 'auto',
					'left': targetLeft,
					'right': targetRight
				});
			}
		} else {
			$('.app-float-submenu').remove();
			targetFloatMenu = '';
		}
	});
	$(document).on('mouseout', '.app-sidebar-minified .app-sidebar .menu > .menu-item.has-sub > .menu-link', function() {
		floatSubMenuTimeout = setTimeout(function() {
			$('.app-float-submenu').remove();
			targetFloatMenu = '';
		}, 250);
	});
}


/* 06. Handle Dropdown Close Option
------------------------------------------------ */
var handleDropdownClose = function() {
	$(document).on('click', '[data-dropdown-close="false"]', function(e) {
		e.stopPropagation();
	});
};


/* 07. Handle Card - Remove / Reload / Collapse / Expand
------------------------------------------------ */
var cardActionRunning = false;
var handleCardAction = function() {
	"use strict";

	if (cardActionRunning) {
		return false;
	}
	cardActionRunning = true;

	// expand
	$(document).on('mouseover', '[data-toggle=card-expand]', function(e) {
		if (!$(this).attr('data-init')) {
			$(this).tooltip({
				title: 'Expand / Compress',
				placement: 'bottom',
				trigger: 'hover',
				container: 'body'
			});
			$(this).tooltip('show');
			$(this).attr('data-init', true);
		}
	});
	$(document).on('click', '[data-toggle=card-expand]', function(e) {
		e.preventDefault();
		var target = $(this).closest('.card');
		var targetBody = $(target).find('.card-body');
		var targetClass = 'card-expand';
		var targetTop = 40;
		if ($(targetBody).length !== 0) {
			var targetOffsetTop = $(target).offset().top;
			var targetBodyOffsetTop = $(targetBody).offset().top;
			targetTop = targetBodyOffsetTop - targetOffsetTop;
		}

		if ($('body').hasClass(targetClass) && $(target).hasClass(targetClass)) {
			$('body, .card').removeClass(targetClass);
			$('.card').removeAttr('style');
			$(targetBody).removeAttr('style');
		} else {
			$('body').addClass(targetClass);
			$(this).closest('.card').addClass(targetClass);
		}
		$(window).trigger('resize');
	});
};


/* 08. Handle Tooltip & Popover Activation
------------------------------------------------ */
var handelTooltipPopoverActivation = function() {
	"use strict";
	if ($('[data-toggle="tooltip"]').length !== 0) {
		$('[data-toggle=tooltip]').tooltip();
	}
	if ($('[data-toggle="popover"]').length !== 0) {
		$('[data-toggle=popover]').popover();
	}
};


/* 09. Handle Scroll to Top Button Activation
------------------------------------------------ */
var handleScrollToTopButton = function() {
	"use strict";
	$(document).on('scroll', function() {
		var totalScroll = $(document).scrollTop();

		if (totalScroll >= 200) {
			$('[data-click=scroll-top]').addClass('show');
		} else {
			$('[data-click=scroll-top]').removeClass('show');
		}
	});
	$('[data-click=scroll-top]').on('click', function(e) {
		e.preventDefault();
		$('html, body, .content').animate({
			scrollTop: $("body").offset().top
		}, 500);
	});
};


/* 10. Handle hexToRgba
------------------------------------------------ */
var hexToRgba = function(hex, transparent = 1) {
	var c;
	if(/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)){
			c= hex.substring(1).split('');
			if(c.length== 3){
					c= [c[0], c[0], c[1], c[1], c[2], c[2]];
			}
			c= '0x'+c.join('');
			return 'rgba('+[(c>>16)&255, (c>>8)&255, c&255].join(',')+','+ transparent +')';
	}
  throw new Error('Bad Hex');
};


/* 11. Handle Scroll to
------------------------------------------------ */
var handleScrollTo = function() {
	$(document).on('click', '[data-toggle="scroll-to"]', function(e) {
		e.preventDefault();
		
		var targetElm = ($(this).attr('data-target')) ? $(this).attr('data-target') : $(this).attr('href');
		if (targetElm) {
			$('html, body').animate({
				scrollTop: $(targetElm).offset().top - $('#header').height() - 24
			}, 0);
		}
	});
};


/* 12. Handle Theme Panel Expand
------------------------------------------------ */
var handleThemePanelExpand = function() {
	$(document).on('click', '[data-click="theme-panel-expand"]', function() {
		var targetContainer = '.theme-panel';
		var targetClass = 'active';
		if ($(targetContainer).hasClass(targetClass)) {
			$(targetContainer).removeClass(targetClass);
			Cookies.set('theme-panel', 'collapse');
		} else {
			$(targetContainer).addClass(targetClass);
			Cookies.set('theme-panel', 'expand');
		}
	});
	
	if (Cookies.get('theme-panel') && Cookies.get('theme-panel') == 'expand') {
		$('[data-click="theme-panel-expand"]').trigger('click');
	}
};


/* 13. Handle Theme Page Control
------------------------------------------------ */
var handleThemePageControl = function() {
	if (typeof Cookies !== 'undefined') {
		$(document).on('click', '.theme-list [data-theme]', function(e) {	
			e.preventDefault();
			var targetThemeClass = $(this).attr('data-theme');
		
			for (var x = 0; x < document.body.classList.length; x++) {
				var targetClass = document.body.classList[x];
				if (targetClass.search('theme-') > -1) {
					$('body').removeClass(targetClass);
				}
			}
		
			$('body').addClass(targetThemeClass);
			$('.theme-list [data-theme]').not(this).closest('li').removeClass('active');
			$(this).closest('li').addClass('active');
		
			if (Cookies) {
				Cookies.set('theme', $(this).attr('data-theme'));
				$(document).trigger('theme-change');
			}
		});
		
		$(document).on('change', '.theme-panel [name="app-theme-dark-mode"]', function() {
			var targetCookie = '';
		
			if ($(this).is(':checked')) {
				$('html').addClass('dark-mode');
				targetCookie = 'dark-mode';
			} else {
				$('html').removeClass('dark-mode');
			}
		
			if (Cookies) {
				App.initVariable();
				Cookies.set('app-theme-dark-mode', targetCookie);
				$(document).trigger('theme-change');
			}
		});
		
		if (Cookies.get('theme') && $('.theme-list').length !== 0) {
			var targetElm = '.theme-list [data-theme="'+ Cookies.get('theme') +'"]';
			$(targetElm).trigger('click');
		}
		if (Cookies.get('app-theme-dark-mode') && $('.theme-panel [name="app-theme-dark-mode"]').length !== 0) {
			$('.theme-panel [name="app-theme-dark-mode"]').prop('checked', true).trigger('change');
		}
	}
};


/* 14. Handle Enable Tooltip & Popover
------------------------------------------------ */
var handleEnableTooltip = function() {
	var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
	var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
		return new bootstrap.Tooltip(tooltipTriggerEl)
	});
};


/* Application Controller
------------------------------------------------ */
var App = function () {
	"use strict";
	
	return {
		//main function
		init: function () {
			this.initSidebar();
			this.initHeader();
			this.initComponent();
			this.initVariable();
		},
		initSidebar: function() {
			handleSidebarMinifyFloatMenu();
			handleSidebarMenu();
			handleSidebarMinify();
			handleSidebarMobileToggle();
			handleSidebarMobileDismiss();
		},
		initHeader: function() {
		},
		initComponent: function() {
			handleSlimScroll();
			handleCardAction();
			handelTooltipPopoverActivation();
			handleScrollToTopButton();
			handleDropdownClose();
			handleScrollTo();
			handleThemePanelExpand();
			handleThemePageControl();
			handleEnableTooltip();
		},
		scrollTop: function() {
			$('html, body, .content').animate({
				scrollTop: $('body').offset().top
			}, 0);
		},
		getCssVariable: function(variable) {
			return window.getComputedStyle(document.body).getPropertyValue(variable).trim();
		},
		initVariable: function() {
			app.color.theme          = this.getCssVariable('--app-theme');
			app.font.family          = this.getCssVariable('--bs-body-font-family');
			app.font.size            = this.getCssVariable('--bs-body-font-size');
			app.font.weight          = this.getCssVariable('--bs-body-font-weight');
			app.color.componentColor = this.getCssVariable('--app-component-color');
			app.color.componentBg    = this.getCssVariable('--app-component-bg');
			app.color.dark           = this.getCssVariable('--bs-dark');
			app.color.light          = this.getCssVariable('--bs-light');
			app.color.blue           = this.getCssVariable('--bs-blue');
			app.color.indigo         = this.getCssVariable('--bs-indigo');
			app.color.purple         = this.getCssVariable('--bs-purple');
			app.color.pink           = this.getCssVariable('--bs-pink');
			app.color.red            = this.getCssVariable('--bs-red');
			app.color.orange         = this.getCssVariable('--bs-orange');
			app.color.yellow         = this.getCssVariable('--bs-yellow');
			app.color.green          = this.getCssVariable('--bs-green');
			app.color.success        = this.getCssVariable('--bs-success');
			app.color.teal           = this.getCssVariable('--bs-teal');
			app.color.cyan           = this.getCssVariable('--bs-cyan');
			app.color.white          = this.getCssVariable('--bs-white');
			app.color.gray           = this.getCssVariable('--bs-gray');
			app.color.lime           = this.getCssVariable('--bs-lime');
			app.color.gray100        = this.getCssVariable('--bs-gray-100');
			app.color.gray200        = this.getCssVariable('--bs-gray-200');
			app.color.gray300        = this.getCssVariable('--bs-gray-300');
			app.color.gray400        = this.getCssVariable('--bs-gray-400');
			app.color.gray500        = this.getCssVariable('--bs-gray-500');
			app.color.gray600        = this.getCssVariable('--bs-gray-600');
			app.color.gray700        = this.getCssVariable('--bs-gray-700');
			app.color.gray800        = this.getCssVariable('--bs-gray-800');
			app.color.gray900        = this.getCssVariable('--bs-gray-900');
			app.color.black          = this.getCssVariable('--bs-black');
			
			app.color.themeRgb          = this.getCssVariable('--app-theme-rgb');
			app.font.familyRgb          = this.getCssVariable('--bs-body-font-family-rgb');
			app.font.sizeRgb            = this.getCssVariable('--bs-body-font-size-rgb');
			app.font.weightRgb          = this.getCssVariable('--bs-body-font-weight-rgb');
			app.color.componentColorRgb = this.getCssVariable('--app-component-color-rgb');
			app.color.componentBgRgb    = this.getCssVariable('--app-component-bg-rgb');
			app.color.darkRgb           = this.getCssVariable('--bs-dark-rgb');
			app.color.lightRgb          = this.getCssVariable('--bs-light-rgb');
			app.color.blueRgb           = this.getCssVariable('--bs-blue-rgb');
			app.color.indigoRgb         = this.getCssVariable('--bs-indigo-rgb');
			app.color.purpleRgb         = this.getCssVariable('--bs-purple-rgb');
			app.color.pinkRgb           = this.getCssVariable('--bs-pink-rgb');
			app.color.redRgb            = this.getCssVariable('--bs-red-rgb');
			app.color.orangeRgb         = this.getCssVariable('--bs-orange-rgb');
			app.color.yellowRgb         = this.getCssVariable('--bs-yellow-rgb');
			app.color.greenRgb          = this.getCssVariable('--bs-green-rgb');
			app.color.successRgb        = this.getCssVariable('--bs-success-rgb');
			app.color.tealRgb           = this.getCssVariable('--bs-teal-rgb');
			app.color.cyanRgb           = this.getCssVariable('--bs-cyan-rgb');
			app.color.whiteRgb          = this.getCssVariable('--bs-white-rgb');
			app.color.grayRgb           = this.getCssVariable('--bs-gray-rgb');
			app.color.limeRgb           = this.getCssVariable('--bs-lime-rgb');
			app.color.gray100Rgb        = this.getCssVariable('--bs-gray-100-rgb');
			app.color.gray200Rgb        = this.getCssVariable('--bs-gray-200-rgb');
			app.color.gray300Rgb        = this.getCssVariable('--bs-gray-300-rgb');
			app.color.gray400Rgb        = this.getCssVariable('--bs-gray-400-rgb');
			app.color.gray500Rgb        = this.getCssVariable('--bs-gray-500-rgb');
			app.color.gray600Rgb        = this.getCssVariable('--bs-gray-600-rgb');
			app.color.gray700Rgb        = this.getCssVariable('--bs-gray-700-rgb');
			app.color.gray800Rgb        = this.getCssVariable('--bs-gray-800-rgb');
			app.color.gray900Rgb        = this.getCssVariable('--bs-gray-900-rgb');
			app.color.blackRgb          = this.getCssVariable('--bs-black-rgb');
		}
	};
}();

$(document).ready(function() {
	App.init();
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuVGVtcGxhdGUgTmFtZTogU1RVRElPIC0gUmVzcG9uc2l2ZSBCb290c3RyYXAgNSBBZG1pbiBUZW1wbGF0ZVxuVmVyc2lvbjogMy4wLjBcbkF1dGhvcjogU2VhbiBOZ3Vcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdEFQUFMgQ09OVEVOVCBUQUJMRVxuXHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cblx0PCEtLSA9PT09PT09PSBHTE9CQUwgU0NSSVBUIFNFVFRJTkcgPT09PT09PT0gLS0+XG4gIDAxLiBHbG9iYWwgVmFyaWFibGVcbiAgMDIuIEhhbmRsZSBTY3JvbGxiYXJcbiAgMDMuIEhhbmRsZSBTaWRlYmFyIE1lbnVcbiAgMDQuIEhhbmRsZSBTaWRlYmFyIE1pbmlmeVxuICAwNS4gSGFuZGxlIFNpZGViYXIgTWluaWZ5IEZsb2F0IE1lbnVcbiAgMDYuIEhhbmRsZSBEcm9wZG93biBDbG9zZSBPcHRpb25cbiAgMDcuIEhhbmRsZSBDYXJkIC0gUmVtb3ZlIC8gUmVsb2FkIC8gQ29sbGFwc2UgLyBFeHBhbmRcbiAgMDguIEhhbmRsZSBUb29sdGlwICYgUG9wb3ZlciBBY3RpdmF0aW9uXG4gIDA5LiBIYW5kbGUgU2Nyb2xsIHRvIFRvcCBCdXR0b24gQWN0aXZhdGlvblxuICAxMC4gSGFuZGxlIGhleFRvUmdiYVxuICAxMS4gSGFuZGxlIFNjcm9sbCB0b1xuICAxMi4gSGFuZGxlIFRoZW1lIFBhbmVsIEV4cGFuZFxuICAxMy4gSGFuZGxlIFRoZW1lIFBhZ2UgQ29udHJvbFxuICAxNC4gSGFuZGxlIEVuYWJsZSBUb29sdGlwICYgUG9wb3ZlclxuXHRcblx0PCEtLSA9PT09PT09PSBBUFBMSUNBVElPTiBTRVRUSU5HID09PT09PT09IC0tPlxuXHRBcHBsaWNhdGlvbiBDb250cm9sbGVyXG4qL1xuXG5cblxuLyogMDEuIEdsb2JhbCBWYXJpYWJsZVxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgYXBwID0ge1xuXHRmb250OiB7XG5cdFxuXHR9LFxuXHRjb2xvcjoge1xuXHRcblx0fVxufVxuXG5cbi8qIDAyLiBIYW5kbGUgU2Nyb2xsYmFyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVTbGltU2Nyb2xsID0gZnVuY3Rpb24oKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXHQkLndoZW4oJCgnW2RhdGEtc2Nyb2xsYmFyPXRydWVdJykuZWFjaCggZnVuY3Rpb24oKSB7XG5cdFx0Z2VuZXJhdGVTbGltU2Nyb2xsKCQodGhpcykpO1xuXHR9KSkuZG9uZShmdW5jdGlvbigpIHtcblx0XHQkKCdbZGF0YS1zY3JvbGxiYXI9XCJ0cnVlXCJdJykubW91c2VvdmVyKCk7XG5cdH0pO1xufTtcbnZhciBnZW5lcmF0ZVNsaW1TY3JvbGwgPSBmdW5jdGlvbihlbGVtZW50KSB7XG5cdHZhciBpc01vYmlsZSA9ICgvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpO1xuXHRcblx0aWYgKCQoZWxlbWVudCkuYXR0cignZGF0YS1pbml0JykgfHwgKGlzTW9iaWxlICYmICQoZWxlbWVudCkuYXR0cignZGF0YS1za2lwLW1vYmlsZScpKSkge1xuXHRcdHJldHVybjtcblx0fVxuXHR2YXIgZGF0YUhlaWdodCA9ICQoZWxlbWVudCkuYXR0cignZGF0YS1oZWlnaHQnKTtcblx0XHRkYXRhSGVpZ2h0ID0gKCFkYXRhSGVpZ2h0KSA/ICQoZWxlbWVudCkuaGVpZ2h0KCkgOiBkYXRhSGVpZ2h0O1xuXG5cdHZhciBzY3JvbGxCYXJPcHRpb24gPSB7XG5cdFx0aGVpZ2h0OiBkYXRhSGVpZ2h0LCBcblx0XHRhbHdheXNWaXNpYmxlOiBmYWxzZVxuXHR9O1xuXHRpZihpc01vYmlsZSkge1xuXHRcdCQoZWxlbWVudCkuY3NzKCdoZWlnaHQnLCBkYXRhSGVpZ2h0KTtcblx0XHQkKGVsZW1lbnQpLmNzcygnb3ZlcmZsb3cteCcsJ3Njcm9sbCcpO1xuXHR9IGVsc2Uge1xuXHRcdCQoZWxlbWVudCkuc2xpbVNjcm9sbChzY3JvbGxCYXJPcHRpb24pO1xuXHRcdCQoZWxlbWVudCkuY2xvc2VzdCgnLnNsaW1TY3JvbGxEaXYnKS5maW5kKCcuc2xpbVNjcm9sbEJhcicpLmhpZGUoKTtcblx0fVxuXHQkKGVsZW1lbnQpLmF0dHIoJ2RhdGEtaW5pdCcsIHRydWUpO1xufTtcblxuXG4vKiAwMy4gSGFuZGxlIFNpZGViYXIgTWVudVxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGxlU2lkZWJhck1lbnUgPSBmdW5jdGlvbigpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuYXBwLXNpZGViYXIgLm1lbnUgPiAubWVudS1pdGVtLmhhcy1zdWIgPiAubWVudS1saW5rJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcblx0XHR2YXIgdGFyZ2V0ID0gJCh0aGlzKS5uZXh0KCcubWVudS1zdWJtZW51Jyk7XG5cdFx0dmFyIG90aGVyTWVudSA9ICQoJy5hcHAtc2lkZWJhciAubWVudSA+IC5tZW51LWl0ZW0uaGFzLXN1YiA+IC5tZW51LXN1Ym1lbnUnKS5ub3QodGFyZ2V0KTtcblxuXHRcdGlmICgkKCcuYXBwLXNpZGViYXItbWluaWZpZWQnKS5sZW5ndGggPT09IDApIHtcblx0XHRcdCQob3RoZXJNZW51KS5zbGlkZVVwKDI1MCk7XG5cdFx0XHQkKG90aGVyTWVudSkuY2xvc2VzdCgnLm1lbnUtaXRlbScpLnJlbW92ZUNsYXNzKCdleHBhbmQnKTtcblx0XHRcdFxuXHRcdFx0JCh0YXJnZXQpLnNsaWRlVG9nZ2xlKDI1MCk7XG5cdFx0XHR2YXIgdGFyZ2V0RWxtID0gJCh0YXJnZXQpLmNsb3Nlc3QoJy5tZW51LWl0ZW0nKTtcblx0XHRcdGlmICgkKHRhcmdldEVsbSkuaGFzQ2xhc3MoJ2V4cGFuZCcpKSB7XG5cdFx0XHRcdCQodGFyZ2V0RWxtKS5yZW1vdmVDbGFzcygnZXhwYW5kJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkKHRhcmdldEVsbSkuYWRkQ2xhc3MoJ2V4cGFuZCcpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsICcuYXBwLXNpZGViYXIgLm1lbnUgPiAubWVudS1pdGVtLmhhcy1zdWIgLm1lbnUtc3VibWVudSAubWVudS1pdGVtLmhhcy1zdWIgPiAubWVudS1saW5rJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcblx0XHRpZiAoJCgnLmFwcC1zaWRlYmFyLW1pbmlmaWVkJykubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR2YXIgdGFyZ2V0ID0gJCh0aGlzKS5uZXh0KCcubWVudS1zdWJtZW51Jyk7XG5cdFx0XHQkKHRhcmdldCkuc2xpZGVUb2dnbGUoMjUwKTtcblx0XHR9XG5cdH0pO1xufTtcblxuXG4vKiAwNC4gSGFuZGxlIFNpZGViYXIgTWluaWZ5XG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBNT0JJTEVfU0lERUJBUl9UT0dHTEVfQ0xBU1MgPSAnYXBwLXNpZGViYXItbW9iaWxlLXRvZ2dsZWQnO1xudmFyIE1PQklMRV9TSURFQkFSX0NMT1NFRF9DTEFTUyA9ICdhcHAtc2lkZWJhci1tb2JpbGUtY2xvc2VkJztcbnZhciBoYW5kbGVTaWRlYmFyTWluaWZ5ID0gZnVuY3Rpb24oKSB7XG5cdCQoJ1tkYXRhLXRvZ2dsZT1cInNpZGViYXItbWluaWZ5XCJdJykub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcblx0XHR2YXIgdGFyZ2V0RWxtID0gJyNhcHAnO1xuXHRcdHZhciB0YXJnZXRDbGFzcyA9ICdhcHAtc2lkZWJhci1taW5pZmllZCc7XG5cdFx0XG5cdFx0aWYgKCQodGFyZ2V0RWxtKS5oYXNDbGFzcyh0YXJnZXRDbGFzcykpIHtcblx0XHRcdCQodGFyZ2V0RWxtKS5yZW1vdmVDbGFzcyh0YXJnZXRDbGFzcyk7XG5cdFx0XHRsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnYXBwU2lkZWJhck1pbmlmaWVkJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQodGFyZ2V0RWxtKS5hZGRDbGFzcyh0YXJnZXRDbGFzcyk7XG5cdFx0XHRsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYXBwU2lkZWJhck1pbmlmaWVkJywgdHJ1ZSk7XG5cdFx0fVxuXHR9KTtcblx0XG5cdGlmICh0eXBlb2YoU3RvcmFnZSkgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0aWYgKGxvY2FsU3RvcmFnZS5hcHBTaWRlYmFyTWluaWZpZWQpIHtcblx0XHRcdCQoJyNhcHAnKS5hZGRDbGFzcygnYXBwLXNpZGViYXItbWluaWZpZWQnKTtcblx0XHR9XG5cdH1cbn07XG52YXIgaGFuZGxlU2lkZWJhck1vYmlsZVRvZ2dsZSA9IGZ1bmN0aW9uKCkge1xuXHQkKGRvY3VtZW50KS5vbignY2xpY2snLCAnW2RhdGEtdG9nZ2xlPVwic2lkZWJhci1tb2JpbGVcIl0nLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFxuXHRcdHZhciB0YXJnZXRFbG0gPSAnI2FwcCc7XG5cdFx0XG5cdFx0JCh0YXJnZXRFbG0pLnJlbW92ZUNsYXNzKE1PQklMRV9TSURFQkFSX0NMT1NFRF9DTEFTUykuYWRkQ2xhc3MoTU9CSUxFX1NJREVCQVJfVE9HR0xFX0NMQVNTKTtcblx0fSk7XG59O1xudmFyIGhhbmRsZVNpZGViYXJNb2JpbGVEaXNtaXNzID0gZnVuY3Rpb24oKSB7XG5cdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1kaXNtaXNzPVwic2lkZWJhci1tb2JpbGVcIl0nLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFxuXHRcdHZhciB0YXJnZXRFbG0gPSAnI2FwcCc7XG5cdFx0XG5cdFx0JCh0YXJnZXRFbG0pLnJlbW92ZUNsYXNzKE1PQklMRV9TSURFQkFSX1RPR0dMRV9DTEFTUykuYWRkQ2xhc3MoTU9CSUxFX1NJREVCQVJfQ0xPU0VEX0NMQVNTKTtcblx0XHRzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHRcdFx0JCh0YXJnZXRFbG0pLnJlbW92ZUNsYXNzKE1PQklMRV9TSURFQkFSX0NMT1NFRF9DTEFTUyk7XG5cdFx0fSwgMjUwKTtcblx0fSk7XG59O1xuXG5cbi8qIDA1LiBIYW5kbGUgU2lkZWJhciBNaW5pZnkgRmxvYXQgTWVudVxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgZmxvYXRTdWJNZW51VGltZW91dDtcbnZhciB0YXJnZXRGbG9hdE1lbnU7XG52YXIgaGFuZGxlTW91c2VvdmVyRmxvYXRTdWJNZW51ID0gZnVuY3Rpb24oZWxtKSB7XG5cdGNsZWFyVGltZW91dChmbG9hdFN1Yk1lbnVUaW1lb3V0KTtcbn07XG52YXIgaGFuZGxlTW91c2VvdXRGbG9hdFN1Yk1lbnUgPSBmdW5jdGlvbihlbG0pIHtcblx0ZmxvYXRTdWJNZW51VGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0JCgnLmFwcC1mbG9hdC1zdWJtZW51JykucmVtb3ZlKCk7XG5cdH0sIDI1MCk7XG59O1xudmFyIGhhbmRsZVNpZGViYXJNaW5pZnlGbG9hdE1lbnUgPSBmdW5jdGlvbigpIHtcblx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgJy5hcHAtZmxvYXQtc3VibWVudSAubWVudS1pdGVtLmhhcy1zdWIgPiAubWVudS1saW5rJywgZnVuY3Rpb24oZSkge1xuXHRcdGUucHJldmVudERlZmF1bHQoKTtcblx0XHRcblx0XHR2YXIgdGFyZ2V0ID0gJCh0aGlzKS5uZXh0KCcubWVudS1zdWJtZW51Jyk7XG5cdFx0JCh0YXJnZXQpLnNsaWRlVG9nZ2xlKDI1MCwgZnVuY3Rpb24oKSB7XG5cdFx0XHR2YXIgdGFyZ2V0TWVudSA9ICQoJy5hcHAtZmxvYXQtc3VibWVudScpO1xuXHRcdFx0dmFyIHRhcmdldEhlaWdodCA9ICQodGFyZ2V0TWVudSkuaGVpZ2h0KCkgKyAyMDtcblx0XHRcdHZhciB0YXJnZXRPZmZzZXQgPSAkKHRhcmdldE1lbnUpLm9mZnNldCgpO1xuXHRcdFx0dmFyIHRhcmdldFRvcCA9ICQodGFyZ2V0TWVudSkuYXR0cignZGF0YS1vZmZzZXQtdG9wJyk7XG5cdFx0XHR2YXIgd2luZG93SGVpZ2h0ID0gJCh3aW5kb3cpLmhlaWdodCgpO1xuXHRcdFx0aWYgKCh3aW5kb3dIZWlnaHQgLSB0YXJnZXRUb3ApID4gdGFyZ2V0SGVpZ2h0KSB7XG5cdFx0XHRcdCQoJy5hcHAtZmxvYXQtc3VibWVudScpLmNzcyh7XG5cdFx0XHRcdFx0J3RvcCc6IHRhcmdldFRvcCxcblx0XHRcdFx0XHQnYm90dG9tJzogJ2F1dG8nLFxuXHRcdFx0XHRcdCdvdmVyZmxvdyc6ICdpbml0aWFsJ1xuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCQoJy5hcHAtZmxvYXQtc3VibWVudScpLmNzcyh7XG5cdFx0XHRcdFx0J2JvdHRvbSc6IDAsXG5cdFx0XHRcdFx0J292ZXJmbG93JzogJ3Njcm9sbCdcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH0pO1xuXHQkKGRvY3VtZW50KS5vbignbW91c2VvdmVyJywgJy5hcHAtc2lkZWJhci1taW5pZmllZCAuYXBwLXNpZGViYXIgLm1lbnUgLm1lbnUtaXRlbS5oYXMtc3ViID4gLm1lbnUtbGluaycsIGZ1bmN0aW9uKCkge1xuXHRcdGNsZWFyVGltZW91dChmbG9hdFN1Yk1lbnVUaW1lb3V0KTtcblx0XHRcblx0XHR2YXIgdGFyZ2V0TWVudSA9ICQodGhpcykuY2xvc2VzdCgnLm1lbnUtaXRlbScpLmZpbmQoJy5tZW51LXN1Ym1lbnUnKS5maXJzdCgpO1xuXHRcdGlmICh0YXJnZXRGbG9hdE1lbnUgPT0gdGhpcykge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR0YXJnZXRGbG9hdE1lbnUgPSB0aGlzO1xuXHRcdH1cblx0XHR2YXIgdGFyZ2V0TWVudUh0bWwgPSAkKHRhcmdldE1lbnUpLmh0bWwoKTtcblx0XHRcblx0XHRpZiAodGFyZ2V0TWVudUh0bWwpIHtcblx0XHRcdHZhciB0YXJnZXRIZWlnaHQgPSAkKHRhcmdldE1lbnUpLmhlaWdodCgpICsgMjA7XG5cdFx0XHR2YXIgdGFyZ2V0T2Zmc2V0ID0gJCh0aGlzKS5vZmZzZXQoKTtcblx0XHRcdHZhciB0YXJnZXRUb3AgPSB0YXJnZXRPZmZzZXQudG9wIC0gJCh3aW5kb3cpLnNjcm9sbFRvcCgpO1xuXHRcdFx0dmFyIHRhcmdldExlZnQgPSAoJCgnYm9keScpLmNzcygnZGlyZWN0aW9uJykgIT0gJ3J0bCcpID8gJCgnI3NpZGViYXInKS53aWR0aCgpICsgJCgnI3NpZGViYXInKS5vZmZzZXQoKS5sZWZ0IDogJ2F1dG8nO1xuXHRcdFx0dmFyIHRhcmdldFJpZ2h0ID0gKCQoJ2JvZHknKS5jc3MoJ2RpcmVjdGlvbicpICE9ICdydGwnKSA/ICdhdXRvJyA6ICQoJyNzaWRlYmFyJykud2lkdGgoKTtcblx0XHRcdHZhciB3aW5kb3dIZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCk7XG5cdFx0XHR2YXIgc3VibWVudUhlaWdodCA9IDA7XG5cdFx0XHRcblx0XHRcdGlmICgkKCcuYXBwLWZsb2F0LXN1Ym1lbnUnKS5sZW5ndGggPT0gMCkge1xuXHRcdFx0XHR0YXJnZXRNZW51SHRtbCA9ICc8ZGl2IGNsYXNzPVwiYXBwLWZsb2F0LXN1Ym1lbnVcIiBkYXRhLW9mZnNldC10b3A9XCInKyB0YXJnZXRUb3AgKydcIiBvbm1vdXNlb3Zlcj1cImhhbmRsZU1vdXNlb3ZlckZsb2F0U3ViTWVudSh0aGlzKVwiIG9ubW91c2VvdXQ9XCJoYW5kbGVNb3VzZW91dEZsb2F0U3ViTWVudSh0aGlzKVwiPicgKyB0YXJnZXRNZW51SHRtbCArICc8L2Rpdj4nO1xuXHRcdFx0XHQkKCdib2R5JykuYXBwZW5kKHRhcmdldE1lbnVIdG1sKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCQoJy5hcHAtZmxvYXQtc3VibWVudScpLmh0bWwodGFyZ2V0TWVudUh0bWwpO1xuXHRcdFx0fVxuXHRcdFx0c3VibWVudUhlaWdodCA9ICQoJy5hcHAtZmxvYXQtc3VibWVudScpLmhlaWdodCgpO1xuXHRcdFx0aWYgKCh3aW5kb3dIZWlnaHQgLSB0YXJnZXRUb3ApID4gdGFyZ2V0SGVpZ2h0ICYmICgodGFyZ2V0VG9wICsgc3VibWVudUhlaWdodCkgPCB3aW5kb3dIZWlnaHQpKSB7XG5cdFx0XHRcdCQoJy5hcHAtZmxvYXQtc3VibWVudScpLmNzcyh7XG5cdFx0XHRcdFx0J3RvcCc6IHRhcmdldFRvcCxcblx0XHRcdFx0XHQnbGVmdCc6IHRhcmdldExlZnQsXG5cdFx0XHRcdFx0J2JvdHRvbSc6ICdhdXRvJyxcblx0XHRcdFx0XHQncmlnaHQnOiB0YXJnZXRSaWdodFxuXHRcdFx0XHR9KTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdCQoJy5hcHAtZmxvYXQtc3VibWVudScpLmNzcyh7XG5cdFx0XHRcdFx0J2JvdHRvbSc6IDAsXG5cdFx0XHRcdFx0J3RvcCc6ICdhdXRvJyxcblx0XHRcdFx0XHQnbGVmdCc6IHRhcmdldExlZnQsXG5cdFx0XHRcdFx0J3JpZ2h0JzogdGFyZ2V0UmlnaHRcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQoJy5hcHAtZmxvYXQtc3VibWVudScpLnJlbW92ZSgpO1xuXHRcdFx0dGFyZ2V0RmxvYXRNZW51ID0gJyc7XG5cdFx0fVxuXHR9KTtcblx0JChkb2N1bWVudCkub24oJ21vdXNlb3V0JywgJy5hcHAtc2lkZWJhci1taW5pZmllZCAuYXBwLXNpZGViYXIgLm1lbnUgPiAubWVudS1pdGVtLmhhcy1zdWIgPiAubWVudS1saW5rJywgZnVuY3Rpb24oKSB7XG5cdFx0ZmxvYXRTdWJNZW51VGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdFx0XHQkKCcuYXBwLWZsb2F0LXN1Ym1lbnUnKS5yZW1vdmUoKTtcblx0XHRcdHRhcmdldEZsb2F0TWVudSA9ICcnO1xuXHRcdH0sIDI1MCk7XG5cdH0pO1xufVxuXG5cbi8qIDA2LiBIYW5kbGUgRHJvcGRvd24gQ2xvc2UgT3B0aW9uXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoYW5kbGVEcm9wZG93bkNsb3NlID0gZnVuY3Rpb24oKSB7XG5cdCQoZG9jdW1lbnQpLm9uKCdjbGljaycsICdbZGF0YS1kcm9wZG93bi1jbG9zZT1cImZhbHNlXCJdJywgZnVuY3Rpb24oZSkge1xuXHRcdGUuc3RvcFByb3BhZ2F0aW9uKCk7XG5cdH0pO1xufTtcblxuXG4vKiAwNy4gSGFuZGxlIENhcmQgLSBSZW1vdmUgLyBSZWxvYWQgLyBDb2xsYXBzZSAvIEV4cGFuZFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgY2FyZEFjdGlvblJ1bm5pbmcgPSBmYWxzZTtcbnZhciBoYW5kbGVDYXJkQWN0aW9uID0gZnVuY3Rpb24oKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdGlmIChjYXJkQWN0aW9uUnVubmluZykge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXHRjYXJkQWN0aW9uUnVubmluZyA9IHRydWU7XG5cblx0Ly8gZXhwYW5kXG5cdCQoZG9jdW1lbnQpLm9uKCdtb3VzZW92ZXInLCAnW2RhdGEtdG9nZ2xlPWNhcmQtZXhwYW5kXScsIGZ1bmN0aW9uKGUpIHtcblx0XHRpZiAoISQodGhpcykuYXR0cignZGF0YS1pbml0JykpIHtcblx0XHRcdCQodGhpcykudG9vbHRpcCh7XG5cdFx0XHRcdHRpdGxlOiAnRXhwYW5kIC8gQ29tcHJlc3MnLFxuXHRcdFx0XHRwbGFjZW1lbnQ6ICdib3R0b20nLFxuXHRcdFx0XHR0cmlnZ2VyOiAnaG92ZXInLFxuXHRcdFx0XHRjb250YWluZXI6ICdib2R5J1xuXHRcdFx0fSk7XG5cdFx0XHQkKHRoaXMpLnRvb2x0aXAoJ3Nob3cnKTtcblx0XHRcdCQodGhpcykuYXR0cignZGF0YS1pbml0JywgdHJ1ZSk7XG5cdFx0fVxuXHR9KTtcblx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgJ1tkYXRhLXRvZ2dsZT1jYXJkLWV4cGFuZF0nLCBmdW5jdGlvbihlKSB7XG5cdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdHZhciB0YXJnZXQgPSAkKHRoaXMpLmNsb3Nlc3QoJy5jYXJkJyk7XG5cdFx0dmFyIHRhcmdldEJvZHkgPSAkKHRhcmdldCkuZmluZCgnLmNhcmQtYm9keScpO1xuXHRcdHZhciB0YXJnZXRDbGFzcyA9ICdjYXJkLWV4cGFuZCc7XG5cdFx0dmFyIHRhcmdldFRvcCA9IDQwO1xuXHRcdGlmICgkKHRhcmdldEJvZHkpLmxlbmd0aCAhPT0gMCkge1xuXHRcdFx0dmFyIHRhcmdldE9mZnNldFRvcCA9ICQodGFyZ2V0KS5vZmZzZXQoKS50b3A7XG5cdFx0XHR2YXIgdGFyZ2V0Qm9keU9mZnNldFRvcCA9ICQodGFyZ2V0Qm9keSkub2Zmc2V0KCkudG9wO1xuXHRcdFx0dGFyZ2V0VG9wID0gdGFyZ2V0Qm9keU9mZnNldFRvcCAtIHRhcmdldE9mZnNldFRvcDtcblx0XHR9XG5cblx0XHRpZiAoJCgnYm9keScpLmhhc0NsYXNzKHRhcmdldENsYXNzKSAmJiAkKHRhcmdldCkuaGFzQ2xhc3ModGFyZ2V0Q2xhc3MpKSB7XG5cdFx0XHQkKCdib2R5LCAuY2FyZCcpLnJlbW92ZUNsYXNzKHRhcmdldENsYXNzKTtcblx0XHRcdCQoJy5jYXJkJykucmVtb3ZlQXR0cignc3R5bGUnKTtcblx0XHRcdCQodGFyZ2V0Qm9keSkucmVtb3ZlQXR0cignc3R5bGUnKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0JCgnYm9keScpLmFkZENsYXNzKHRhcmdldENsYXNzKTtcblx0XHRcdCQodGhpcykuY2xvc2VzdCgnLmNhcmQnKS5hZGRDbGFzcyh0YXJnZXRDbGFzcyk7XG5cdFx0fVxuXHRcdCQod2luZG93KS50cmlnZ2VyKCdyZXNpemUnKTtcblx0fSk7XG59O1xuXG5cbi8qIDA4LiBIYW5kbGUgVG9vbHRpcCAmIFBvcG92ZXIgQWN0aXZhdGlvblxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGVsVG9vbHRpcFBvcG92ZXJBY3RpdmF0aW9uID0gZnVuY3Rpb24oKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXHRpZiAoJCgnW2RhdGEtdG9nZ2xlPVwidG9vbHRpcFwiXScpLmxlbmd0aCAhPT0gMCkge1xuXHRcdCQoJ1tkYXRhLXRvZ2dsZT10b29sdGlwXScpLnRvb2x0aXAoKTtcblx0fVxuXHRpZiAoJCgnW2RhdGEtdG9nZ2xlPVwicG9wb3ZlclwiXScpLmxlbmd0aCAhPT0gMCkge1xuXHRcdCQoJ1tkYXRhLXRvZ2dsZT1wb3BvdmVyXScpLnBvcG92ZXIoKTtcblx0fVxufTtcblxuXG4vKiAwOS4gSGFuZGxlIFNjcm9sbCB0byBUb3AgQnV0dG9uIEFjdGl2YXRpb25cbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZVNjcm9sbFRvVG9wQnV0dG9uID0gZnVuY3Rpb24oKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXHQkKGRvY3VtZW50KS5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHRvdGFsU2Nyb2xsID0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCk7XG5cblx0XHRpZiAodG90YWxTY3JvbGwgPj0gMjAwKSB7XG5cdFx0XHQkKCdbZGF0YS1jbGljaz1zY3JvbGwtdG9wXScpLmFkZENsYXNzKCdzaG93Jyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQoJ1tkYXRhLWNsaWNrPXNjcm9sbC10b3BdJykucmVtb3ZlQ2xhc3MoJ3Nob3cnKTtcblx0XHR9XG5cdH0pO1xuXHQkKCdbZGF0YS1jbGljaz1zY3JvbGwtdG9wXScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0JCgnaHRtbCwgYm9keSwgLmNvbnRlbnQnKS5hbmltYXRlKHtcblx0XHRcdHNjcm9sbFRvcDogJChcImJvZHlcIikub2Zmc2V0KCkudG9wXG5cdFx0fSwgNTAwKTtcblx0fSk7XG59O1xuXG5cbi8qIDEwLiBIYW5kbGUgaGV4VG9SZ2JhXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbnZhciBoZXhUb1JnYmEgPSBmdW5jdGlvbihoZXgsIHRyYW5zcGFyZW50ID0gMSkge1xuXHR2YXIgYztcblx0aWYoL14jKFtBLUZhLWYwLTldezN9KXsxLDJ9JC8udGVzdChoZXgpKXtcblx0XHRcdGM9IGhleC5zdWJzdHJpbmcoMSkuc3BsaXQoJycpO1xuXHRcdFx0aWYoYy5sZW5ndGg9PSAzKXtcblx0XHRcdFx0XHRjPSBbY1swXSwgY1swXSwgY1sxXSwgY1sxXSwgY1syXSwgY1syXV07XG5cdFx0XHR9XG5cdFx0XHRjPSAnMHgnK2Muam9pbignJyk7XG5cdFx0XHRyZXR1cm4gJ3JnYmEoJytbKGM+PjE2KSYyNTUsIChjPj44KSYyNTUsIGMmMjU1XS5qb2luKCcsJykrJywnKyB0cmFuc3BhcmVudCArJyknO1xuXHR9XG4gIHRocm93IG5ldyBFcnJvcignQmFkIEhleCcpO1xufTtcblxuXG4vKiAxMS4gSGFuZGxlIFNjcm9sbCB0b1xuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGxlU2Nyb2xsVG8gPSBmdW5jdGlvbigpIHtcblx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgJ1tkYXRhLXRvZ2dsZT1cInNjcm9sbC10b1wiXScsIGZ1bmN0aW9uKGUpIHtcblx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XG5cdFx0dmFyIHRhcmdldEVsbSA9ICgkKHRoaXMpLmF0dHIoJ2RhdGEtdGFyZ2V0JykpID8gJCh0aGlzKS5hdHRyKCdkYXRhLXRhcmdldCcpIDogJCh0aGlzKS5hdHRyKCdocmVmJyk7XG5cdFx0aWYgKHRhcmdldEVsbSkge1xuXHRcdFx0JCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuXHRcdFx0XHRzY3JvbGxUb3A6ICQodGFyZ2V0RWxtKS5vZmZzZXQoKS50b3AgLSAkKCcjaGVhZGVyJykuaGVpZ2h0KCkgLSAyNFxuXHRcdFx0fSwgMCk7XG5cdFx0fVxuXHR9KTtcbn07XG5cblxuLyogMTIuIEhhbmRsZSBUaGVtZSBQYW5lbCBFeHBhbmRcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZVRoZW1lUGFuZWxFeHBhbmQgPSBmdW5jdGlvbigpIHtcblx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgJ1tkYXRhLWNsaWNrPVwidGhlbWUtcGFuZWwtZXhwYW5kXCJdJywgZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHRhcmdldENvbnRhaW5lciA9ICcudGhlbWUtcGFuZWwnO1xuXHRcdHZhciB0YXJnZXRDbGFzcyA9ICdhY3RpdmUnO1xuXHRcdGlmICgkKHRhcmdldENvbnRhaW5lcikuaGFzQ2xhc3ModGFyZ2V0Q2xhc3MpKSB7XG5cdFx0XHQkKHRhcmdldENvbnRhaW5lcikucmVtb3ZlQ2xhc3ModGFyZ2V0Q2xhc3MpO1xuXHRcdFx0Q29va2llcy5zZXQoJ3RoZW1lLXBhbmVsJywgJ2NvbGxhcHNlJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQodGFyZ2V0Q29udGFpbmVyKS5hZGRDbGFzcyh0YXJnZXRDbGFzcyk7XG5cdFx0XHRDb29raWVzLnNldCgndGhlbWUtcGFuZWwnLCAnZXhwYW5kJyk7XG5cdFx0fVxuXHR9KTtcblx0XG5cdGlmIChDb29raWVzLmdldCgndGhlbWUtcGFuZWwnKSAmJiBDb29raWVzLmdldCgndGhlbWUtcGFuZWwnKSA9PSAnZXhwYW5kJykge1xuXHRcdCQoJ1tkYXRhLWNsaWNrPVwidGhlbWUtcGFuZWwtZXhwYW5kXCJdJykudHJpZ2dlcignY2xpY2snKTtcblx0fVxufTtcblxuXG4vKiAxMy4gSGFuZGxlIFRoZW1lIFBhZ2UgQ29udHJvbFxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgaGFuZGxlVGhlbWVQYWdlQ29udHJvbCA9IGZ1bmN0aW9uKCkge1xuXHRpZiAodHlwZW9mIENvb2tpZXMgIT09ICd1bmRlZmluZWQnKSB7XG5cdFx0JChkb2N1bWVudCkub24oJ2NsaWNrJywgJy50aGVtZS1saXN0IFtkYXRhLXRoZW1lXScsIGZ1bmN0aW9uKGUpIHtcdFxuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0dmFyIHRhcmdldFRoZW1lQ2xhc3MgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtdGhlbWUnKTtcblx0XHRcblx0XHRcdGZvciAodmFyIHggPSAwOyB4IDwgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QubGVuZ3RoOyB4KyspIHtcblx0XHRcdFx0dmFyIHRhcmdldENsYXNzID0gZG9jdW1lbnQuYm9keS5jbGFzc0xpc3RbeF07XG5cdFx0XHRcdGlmICh0YXJnZXRDbGFzcy5zZWFyY2goJ3RoZW1lLScpID4gLTEpIHtcblx0XHRcdFx0XHQkKCdib2R5JykucmVtb3ZlQ2xhc3ModGFyZ2V0Q2xhc3MpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XG5cdFx0XHQkKCdib2R5JykuYWRkQ2xhc3ModGFyZ2V0VGhlbWVDbGFzcyk7XG5cdFx0XHQkKCcudGhlbWUtbGlzdCBbZGF0YS10aGVtZV0nKS5ub3QodGhpcykuY2xvc2VzdCgnbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cdFx0XHQkKHRoaXMpLmNsb3Nlc3QoJ2xpJykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXHRcdFxuXHRcdFx0aWYgKENvb2tpZXMpIHtcblx0XHRcdFx0Q29va2llcy5zZXQoJ3RoZW1lJywgJCh0aGlzKS5hdHRyKCdkYXRhLXRoZW1lJykpO1xuXHRcdFx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCd0aGVtZS1jaGFuZ2UnKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHQkKGRvY3VtZW50KS5vbignY2hhbmdlJywgJy50aGVtZS1wYW5lbCBbbmFtZT1cImFwcC10aGVtZS1kYXJrLW1vZGVcIl0nLCBmdW5jdGlvbigpIHtcblx0XHRcdHZhciB0YXJnZXRDb29raWUgPSAnJztcblx0XHRcblx0XHRcdGlmICgkKHRoaXMpLmlzKCc6Y2hlY2tlZCcpKSB7XG5cdFx0XHRcdCQoJ2h0bWwnKS5hZGRDbGFzcygnZGFyay1tb2RlJyk7XG5cdFx0XHRcdHRhcmdldENvb2tpZSA9ICdkYXJrLW1vZGUnO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0JCgnaHRtbCcpLnJlbW92ZUNsYXNzKCdkYXJrLW1vZGUnKTtcblx0XHRcdH1cblx0XHRcblx0XHRcdGlmIChDb29raWVzKSB7XG5cdFx0XHRcdEFwcC5pbml0VmFyaWFibGUoKTtcblx0XHRcdFx0Q29va2llcy5zZXQoJ2FwcC10aGVtZS1kYXJrLW1vZGUnLCB0YXJnZXRDb29raWUpO1xuXHRcdFx0XHQkKGRvY3VtZW50KS50cmlnZ2VyKCd0aGVtZS1jaGFuZ2UnKTtcblx0XHRcdH1cblx0XHR9KTtcblx0XHRcblx0XHRpZiAoQ29va2llcy5nZXQoJ3RoZW1lJykgJiYgJCgnLnRoZW1lLWxpc3QnKS5sZW5ndGggIT09IDApIHtcblx0XHRcdHZhciB0YXJnZXRFbG0gPSAnLnRoZW1lLWxpc3QgW2RhdGEtdGhlbWU9XCInKyBDb29raWVzLmdldCgndGhlbWUnKSArJ1wiXSc7XG5cdFx0XHQkKHRhcmdldEVsbSkudHJpZ2dlcignY2xpY2snKTtcblx0XHR9XG5cdFx0aWYgKENvb2tpZXMuZ2V0KCdhcHAtdGhlbWUtZGFyay1tb2RlJykgJiYgJCgnLnRoZW1lLXBhbmVsIFtuYW1lPVwiYXBwLXRoZW1lLWRhcmstbW9kZVwiXScpLmxlbmd0aCAhPT0gMCkge1xuXHRcdFx0JCgnLnRoZW1lLXBhbmVsIFtuYW1lPVwiYXBwLXRoZW1lLWRhcmstbW9kZVwiXScpLnByb3AoJ2NoZWNrZWQnLCB0cnVlKS50cmlnZ2VyKCdjaGFuZ2UnKTtcblx0XHR9XG5cdH1cbn07XG5cblxuLyogMTQuIEhhbmRsZSBFbmFibGUgVG9vbHRpcCAmIFBvcG92ZXJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xudmFyIGhhbmRsZUVuYWJsZVRvb2x0aXAgPSBmdW5jdGlvbigpIHtcblx0dmFyIHRvb2x0aXBUcmlnZ2VyTGlzdCA9IFtdLnNsaWNlLmNhbGwoZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnW2RhdGEtYnMtdG9nZ2xlPVwidG9vbHRpcFwiXScpKVxuXHR2YXIgdG9vbHRpcExpc3QgPSB0b29sdGlwVHJpZ2dlckxpc3QubWFwKGZ1bmN0aW9uICh0b29sdGlwVHJpZ2dlckVsKSB7XG5cdFx0cmV0dXJuIG5ldyBib290c3RyYXAuVG9vbHRpcCh0b29sdGlwVHJpZ2dlckVsKVxuXHR9KTtcbn07XG5cblxuLyogQXBwbGljYXRpb24gQ29udHJvbGxlclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG52YXIgQXBwID0gZnVuY3Rpb24gKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0XG5cdHJldHVybiB7XG5cdFx0Ly9tYWluIGZ1bmN0aW9uXG5cdFx0aW5pdDogZnVuY3Rpb24gKCkge1xuXHRcdFx0dGhpcy5pbml0U2lkZWJhcigpO1xuXHRcdFx0dGhpcy5pbml0SGVhZGVyKCk7XG5cdFx0XHR0aGlzLmluaXRDb21wb25lbnQoKTtcblx0XHRcdHRoaXMuaW5pdFZhcmlhYmxlKCk7XG5cdFx0fSxcblx0XHRpbml0U2lkZWJhcjogZnVuY3Rpb24oKSB7XG5cdFx0XHRoYW5kbGVTaWRlYmFyTWluaWZ5RmxvYXRNZW51KCk7XG5cdFx0XHRoYW5kbGVTaWRlYmFyTWVudSgpO1xuXHRcdFx0aGFuZGxlU2lkZWJhck1pbmlmeSgpO1xuXHRcdFx0aGFuZGxlU2lkZWJhck1vYmlsZVRvZ2dsZSgpO1xuXHRcdFx0aGFuZGxlU2lkZWJhck1vYmlsZURpc21pc3MoKTtcblx0XHR9LFxuXHRcdGluaXRIZWFkZXI6IGZ1bmN0aW9uKCkge1xuXHRcdH0sXG5cdFx0aW5pdENvbXBvbmVudDogZnVuY3Rpb24oKSB7XG5cdFx0XHRoYW5kbGVTbGltU2Nyb2xsKCk7XG5cdFx0XHRoYW5kbGVDYXJkQWN0aW9uKCk7XG5cdFx0XHRoYW5kZWxUb29sdGlwUG9wb3ZlckFjdGl2YXRpb24oKTtcblx0XHRcdGhhbmRsZVNjcm9sbFRvVG9wQnV0dG9uKCk7XG5cdFx0XHRoYW5kbGVEcm9wZG93bkNsb3NlKCk7XG5cdFx0XHRoYW5kbGVTY3JvbGxUbygpO1xuXHRcdFx0aGFuZGxlVGhlbWVQYW5lbEV4cGFuZCgpO1xuXHRcdFx0aGFuZGxlVGhlbWVQYWdlQ29udHJvbCgpO1xuXHRcdFx0aGFuZGxlRW5hYmxlVG9vbHRpcCgpO1xuXHRcdH0sXG5cdFx0c2Nyb2xsVG9wOiBmdW5jdGlvbigpIHtcblx0XHRcdCQoJ2h0bWwsIGJvZHksIC5jb250ZW50JykuYW5pbWF0ZSh7XG5cdFx0XHRcdHNjcm9sbFRvcDogJCgnYm9keScpLm9mZnNldCgpLnRvcFxuXHRcdFx0fSwgMCk7XG5cdFx0fSxcblx0XHRnZXRDc3NWYXJpYWJsZTogZnVuY3Rpb24odmFyaWFibGUpIHtcblx0XHRcdHJldHVybiB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKHZhcmlhYmxlKS50cmltKCk7XG5cdFx0fSxcblx0XHRpbml0VmFyaWFibGU6IGZ1bmN0aW9uKCkge1xuXHRcdFx0YXBwLmNvbG9yLnRoZW1lICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1hcHAtdGhlbWUnKTtcblx0XHRcdGFwcC5mb250LmZhbWlseSAgICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtYm9keS1mb250LWZhbWlseScpO1xuXHRcdFx0YXBwLmZvbnQuc2l6ZSAgICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ib2R5LWZvbnQtc2l6ZScpO1xuXHRcdFx0YXBwLmZvbnQud2VpZ2h0ICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ib2R5LWZvbnQtd2VpZ2h0Jyk7XG5cdFx0XHRhcHAuY29sb3IuY29tcG9uZW50Q29sb3IgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWFwcC1jb21wb25lbnQtY29sb3InKTtcblx0XHRcdGFwcC5jb2xvci5jb21wb25lbnRCZyAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYXBwLWNvbXBvbmVudC1iZycpO1xuXHRcdFx0YXBwLmNvbG9yLmRhcmsgICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1kYXJrJyk7XG5cdFx0XHRhcHAuY29sb3IubGlnaHQgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWxpZ2h0Jyk7XG5cdFx0XHRhcHAuY29sb3IuYmx1ZSAgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWJsdWUnKTtcblx0XHRcdGFwcC5jb2xvci5pbmRpZ28gICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtaW5kaWdvJyk7XG5cdFx0XHRhcHAuY29sb3IucHVycGxlICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLXB1cnBsZScpO1xuXHRcdFx0YXBwLmNvbG9yLnBpbmsgICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1waW5rJyk7XG5cdFx0XHRhcHAuY29sb3IucmVkICAgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLXJlZCcpO1xuXHRcdFx0YXBwLmNvbG9yLm9yYW5nZSAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1vcmFuZ2UnKTtcblx0XHRcdGFwcC5jb2xvci55ZWxsb3cgICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMteWVsbG93Jyk7XG5cdFx0XHRhcHAuY29sb3IuZ3JlZW4gICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWdyZWVuJyk7XG5cdFx0XHRhcHAuY29sb3Iuc3VjY2VzcyAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLXN1Y2Nlc3MnKTtcblx0XHRcdGFwcC5jb2xvci50ZWFsICAgICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtdGVhbCcpO1xuXHRcdFx0YXBwLmNvbG9yLmN5YW4gICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1jeWFuJyk7XG5cdFx0XHRhcHAuY29sb3Iud2hpdGUgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLXdoaXRlJyk7XG5cdFx0XHRhcHAuY29sb3IuZ3JheSAgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWdyYXknKTtcblx0XHRcdGFwcC5jb2xvci5saW1lICAgICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtbGltZScpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXkxMDAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTEwMCcpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXkyMDAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTIwMCcpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXkzMDAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTMwMCcpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXk0MDAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTQwMCcpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXk1MDAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTUwMCcpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXk2MDAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTYwMCcpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXk3MDAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTcwMCcpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXk4MDAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTgwMCcpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXk5MDAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTkwMCcpO1xuXHRcdFx0YXBwLmNvbG9yLmJsYWNrICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ibGFjaycpO1xuXHRcdFx0XG5cdFx0XHRhcHAuY29sb3IudGhlbWVSZ2IgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWFwcC10aGVtZS1yZ2InKTtcblx0XHRcdGFwcC5mb250LmZhbWlseVJnYiAgICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtYm9keS1mb250LWZhbWlseS1yZ2InKTtcblx0XHRcdGFwcC5mb250LnNpemVSZ2IgICAgICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtYm9keS1mb250LXNpemUtcmdiJyk7XG5cdFx0XHRhcHAuZm9udC53ZWlnaHRSZ2IgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWJvZHktZm9udC13ZWlnaHQtcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IuY29tcG9uZW50Q29sb3JSZ2IgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWFwcC1jb21wb25lbnQtY29sb3ItcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IuY29tcG9uZW50QmdSZ2IgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWFwcC1jb21wb25lbnQtYmctcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IuZGFya1JnYiAgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWRhcmstcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IubGlnaHRSZ2IgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWxpZ2h0LXJnYicpO1xuXHRcdFx0YXBwLmNvbG9yLmJsdWVSZ2IgICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ibHVlLXJnYicpO1xuXHRcdFx0YXBwLmNvbG9yLmluZGlnb1JnYiAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1pbmRpZ28tcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IucHVycGxlUmdiICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLXB1cnBsZS1yZ2InKTtcblx0XHRcdGFwcC5jb2xvci5waW5rUmdiICAgICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtcGluay1yZ2InKTtcblx0XHRcdGFwcC5jb2xvci5yZWRSZ2IgICAgICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtcmVkLXJnYicpO1xuXHRcdFx0YXBwLmNvbG9yLm9yYW5nZVJnYiAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1vcmFuZ2UtcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IueWVsbG93UmdiICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLXllbGxvdy1yZ2InKTtcblx0XHRcdGFwcC5jb2xvci5ncmVlblJnYiAgICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtZ3JlZW4tcmdiJyk7XG5cdFx0XHRhcHAuY29sb3Iuc3VjY2Vzc1JnYiAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLXN1Y2Nlc3MtcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IudGVhbFJnYiAgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLXRlYWwtcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IuY3lhblJnYiAgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWN5YW4tcmdiJyk7XG5cdFx0XHRhcHAuY29sb3Iud2hpdGVSZ2IgICAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLXdoaXRlLXJnYicpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXlSZ2IgICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LXJnYicpO1xuXHRcdFx0YXBwLmNvbG9yLmxpbWVSZ2IgICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1saW1lLXJnYicpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXkxMDBSZ2IgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTEwMC1yZ2InKTtcblx0XHRcdGFwcC5jb2xvci5ncmF5MjAwUmdiICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtZ3JheS0yMDAtcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IuZ3JheTMwMFJnYiAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWdyYXktMzAwLXJnYicpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXk0MDBSZ2IgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTQwMC1yZ2InKTtcblx0XHRcdGFwcC5jb2xvci5ncmF5NTAwUmdiICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtZ3JheS01MDAtcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IuZ3JheTYwMFJnYiAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWdyYXktNjAwLXJnYicpO1xuXHRcdFx0YXBwLmNvbG9yLmdyYXk3MDBSZ2IgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ncmF5LTcwMC1yZ2InKTtcblx0XHRcdGFwcC5jb2xvci5ncmF5ODAwUmdiICAgICAgICA9IHRoaXMuZ2V0Q3NzVmFyaWFibGUoJy0tYnMtZ3JheS04MDAtcmdiJyk7XG5cdFx0XHRhcHAuY29sb3IuZ3JheTkwMFJnYiAgICAgICAgPSB0aGlzLmdldENzc1ZhcmlhYmxlKCctLWJzLWdyYXktOTAwLXJnYicpO1xuXHRcdFx0YXBwLmNvbG9yLmJsYWNrUmdiICAgICAgICAgID0gdGhpcy5nZXRDc3NWYXJpYWJsZSgnLS1icy1ibGFjay1yZ2InKTtcblx0XHR9XG5cdH07XG59KCk7XG5cbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuXHRBcHAuaW5pdCgpO1xufSk7Il19
